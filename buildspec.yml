version: 0.2
phases:
  install:
    commands:
      - sudo apt-get update -y
      - curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -
      - sudo apt-get install -y nodejs
      - mkdir -p lambdatest
      - mv -f Lambda/* lambdatest/
      - cd lambdatest
      - npm install
      - zip -r test1.zip *
      - aws s3 cp test1.zip s3://aadhri-test-buck/
      - cd ..
      - chmod 755 check-s3-object-version.sh
      - ./check-s3-object-version.sh
      - aws cloudformation package --template-file data.yaml --s3-bucket aadhri-test-buck
                                   --output-template-file outputdata.yaml   
  build:
    commands:
artifacts:
  type: zip
  files:
    - data.yaml
    - outputdata.yaml
